'Open files
Public Sub openFile(iFilePath As String)
    
    'Dim iFilePath As String
    'sFile = "C:\docs\data.xlsx"
    
    'Use Dir to check if file exists
    If Dir(iFilePath) = vbNullString Then

        'if file does not exist display message
        MsgBox "Could not find the file " & iFilePath
        Exit Sub

    End If
    
    'Code will only reach here if file exists
    Workbooks.Open iFilePath
    
End Sub

'Convert .csv to .xlsx
Public Sub convertCsvToXlsx()

    Dim folderSelection As FileDialog: Set folderSelection = Application.FileDialog(msoFileDialogFolderPicker)
    
    With folderSelection
        .AllowMultiSelect = False
        .Title = "Select the folder with CSV Files"
        .Show
        If .SelectedItems.Count = 0 Then Exit Sub
    End With

    'error handling
    On Error GoTo errorHandler

    'set up loop through iPath
    Dim iFolder As String: iFolder = folderSelection.SelectedItem(1) & "\"
    Dim iExt As String: iExt = "*.csv"
    Dim iFile As Stirng: iFile = Dir(iFolder & iExt)
    Dim iFileName As String
    Dim iFilePath As String: iFolder & iFile
    Dim iWorkbook As Workbook: Set iWorkbook = worksbooks.open(FileName:= iFilePath, ReadOnly:= True)

    For each wb in iWorkbook

        Call openFile(iFile)

    Next workbook



errorHandler:

    MsgBox "The following error has occurred: " & vbCrLf & vbCrLf & "Error Number:" & Err.Number & vbCrLf & _
    "Error Description: " & Err.Description

End Sub

